<!DOCTYPE html>

<html>
<head>
  <title>Presentation</title>
  <meta charset='utf-8'>
  <script src='http://html5slides.googlecode.com/svn/trunk/slides.js'></script>
</head>

<body style='display: none'>
<section class='slides layout-regular '>
  <article>
    <h1>
      Taking JavaScript to the next level
    </h1>

    <p>
      Christian Schwarz og Lars Brandt
      <br>
      19 August 2011
    </p>
  </article>
  <article>
    <h3>
      Agenda
    </h3>
    <ul>
      <li>
        Hvorfor gjøre noe annet enn vi gjør i dag?
      </li>
      <li>
        JavaScript fundamenter
      </li>
      <li>
        Smarte løsninger
      </li>
      <li>
        Testing
      </li>
      <li>
        Eksempel: Ajax
      </li>
      <li>
        Eksempel: Controller + View
      </li>
      <li>
        Lesson learned
      </li>
    </ul>
  </article>

  <article class='smaller'>
    <h3>
      Bring booking
    </h3>

    <p>
      <img style='width: 100%' src="http://i.imgur.com/OuVQ7.png"/>
    </p>
  </article>

  <article class='smaller'>
    <h3>
      Hvorfor gjøre noe annet enn vi gjør i dag?
    </h3>

    <p>
      PackageDetails anno 06.09.2010
    </p><br/>

    <p>
      <img style='width: 100%' src='http://i.imgur.com/v5gnu.png'>
    </p>
  </article>

  <article class='smaller'>
    <h3>
      Hvorfor gjøre noe annet enn vi gjør i dag?
    </h3>

    <p>
      PackageDetails anno 22.09.2010
    </p><br/>

    <p>
      <img style='width: 100%' src='http://i.imgur.com/JnBT1.png'>
    </p>
  </article>

  <article class='smaller'>
    <h3>
      Hvorfor gjøre noe annet enn vi gjør i dag?
    </h3>

    <p>
      PackageDetails anno 01.12.2010
    </p><br/>

    <p>
      <img style='width: 100%' src='http://i.imgur.com/rprLi.png'>
    </p>
  </article>

  <article>
    <h3>
      Hvorfor gjøre noe annet enn vi gjør i dag?
    </h3>
    <br/><br/>

    <p>
      <img src='http://i.imgur.com/Dy3Pc.png'>
    </p>
  </article>

  <article>
    <h3>
      Hvorfor gjøre noe annet enn vi gjør i dag?
    </h3>
    <ul>
      <li>
        Koden er vanskelig å gjenbruke
      </li>
      <li>
        Vanskelig å teste
      </li>
      <li>
        Ingen klar kodestandard
      </li>
      <li>
        Dårlig kvalitet
        <ul style="font-size: 22px">
          <li>Har mer bugs i JavaScript enn i Java selv om det bare utgjør 14% av kodebasen</li>
        </ul>
      </li>
      <li>
        Utfordrende og forbedre/refaktorere koden
      </li>
    </ul>
  </article>

  <article>
    <h3>
      Hva ønsket vi oss?
    </h3>
    <ul>
      <li>
        Ønsket å skrive tester slik vi gjorde med resten av koden
      </li>
      <li>
        Testene måtte kjøre som en del av bygget
      </li>
      <li>
        Forstå JavaScript og heve kvaliteten på koden
      </li>
    </ul>
  </article>

  <article>
    <h1>
      JavaScript fundamenter
    </h1>
  </article>

  <article>
    <h3>
      JavaScript fundamenter
    </h3>
    <ul>
      <li>
        Simple types
      </li>
      <ul style="font-size: 22px">
        <li>Numbers</li>
        <li>String</li>
        <li>Booleans</li>
        <li>null</li>
        <li>undefined</li>
      </ul>
      <li>
        Immutable
      </li>
      <li>
        Alt annet er objekter
      </li>
      <ul style="font-size: 22px">
        <li>Mutable key / value pairs (properties)</li>
      </ul>
    </ul>
  </article>

  <article>
    <h3>
      Objekter
    </h3>
    <ul>
      <li>
        Samling av properties (key / value)
      </li>
      <li>
        Kan legge inn / modifisere properties fra hvor som helst
      </li>
      <li>
        Object literal: {}
      </li>
      <li>
        Link til en prototype
      </li>
      <ul style="font-size: 22px">
        <li>
          property mangler -> prøver prototype’n
        </li>
        <li>
          {} har Object.prototype som prototype
        </li>
        <li>
          Hierarki
        </li>
      </ul>
    </ul>
  </article>
  <article>
    <h3>
      Funksjoner
    </h3>
    <ul>
      <li>
        Kan inneholde kode
      </li>
      <li>
        Er objekter
      </li>
      <ul style="font-size: 22px">
        <li>
          Kan inneholde public felter
        </li>
        <li>
          Kan tilordnes variable og sendes som argumenter
        </li>
      </ul>
      <li>
        Kan ha navn (for rekursivitet + debugging)
      </li>
      <li>
        Function literal
      </li>
    </ul>
    <pre>
  function() {}   //anonym funksjon

  function foo() {}  //er det samme som:

  var foo = function foo() {}
    </pre>
  </article>

  <article>
    <h3>
      Opprette objekter - Legge på felter
    </h3>
    <pre>
  var circle = {};
  circle.radius = 1;
  circle.area = function() { return this.radius * ... }

  var area = circle.area();
    </pre>
  </article>

  <article>
      <h3>
        Opprette objekter - Object literal
      </h3>
      <pre>
  var circle = {
     radius : 1,
     area : function() { return this.radius * ... }
  };
  var area = circle.area();

  //legg merke til “:” og “,”
      </pre>
  </article>

  <article>
    <h3>
      Opprette objekter - Closures
    </h3>
    <ul>
      <pre>
  function circle() {
    var radius = 1;
    return {
      area : function() { return radius * radius * 3.14 }
    }
  }

  //radius er “free variable” som lever videre
  //radius er privat / beskyttet

  alert(circle().area());
      </pre>
      <script type="text/javascript">
        function circle() {
          var radius = 1;
          return {
            area : function() { return radius * radius * 3.14 }
          }
        }
      </script>
    </pre>
    <button style="font-size: 28px;" onclick="alert(circle().area()); return false;">Prøv!</button>

    </ul>
  </article>
  <article>
    <h3>
      Opprette objekter - Construktor funksjon
    </h3>
    <pre>
  function Circle () {
    this.radius = 1;
    this.area = function() { return this.radius * ... };
  }
  var area = new Circle().area();

  //må huske “new” (navnekonvensjon)
    </pre>
  </article>
  
  <article>
    <h3>
      Tilganger / scope 
    </h3>
    <ul>
      <li>
        Variable har function scope
      </li>
      <li>
        Kode utenfor en funksjon har global scope
      </li>
      <ul style="font-size: 22px">
        <li>
          Navnekollisjoner
        </li>
      </ul>
      <li>
        Implicit global scope på udeklarerte variable
      </li>
    </ul>
  </article>
  
  <article>
    <h3>
      Selveksekvering med lokalt scope
    </h3>
    <pre>
  (function() {
     //snurr film
     //lokale variable havner ikke i global scope
     var name = “Ole”;
  }());
    </pre>
  </article>

  <article>
    <h3>
      Variable vs objekt properties
    </h3>
    <pre>
  function Person() {
      var name = "Per";
      this.name = "Ole";
      alert(name);
      alert(this.name);
  }

  new Person();  //hva alertes?
      <script type="text/javascript">
        function Person() {
            var name = "Per";
            this.name = "Ole";
            alert(name);
            alert(this.name);
        }
      </script>
    </pre>
    <button style="font-size: 28px;" onclick="new Person(); return false;">Prøv!</button>
  </article>

  <article>
    <h3>
      This
    </h3>
    <ul>
      <li>
        this har en dynamisk verdi
      </li>
      <li>
        Dot notation (“method invocation”):
      </li>
      <ul style="font-size: 22px">
        <li>
          circle.area() &nbsp;  //circle blir “this”
        </li>
      </ul>
      <li>
        Ikke dot notation (“function invocation”):
      </li>
      <ul style="font-size: 22px">
        <li>
          add(3, 4) &nbsp; // “this” blir global object (window)
        </li>
      </ul>
      <li>
        Eksplisitt sette this
      </li>
      <ul style="font-size: 22px">
        <li>
          someFunction.call(thisVerdi, arg1, arg2)
        </li>
        <li>
          someFunction.apply(thisVerdi, arguments)
        </li>
      </ul>
    </ul>
  </article>

  <article>
    <h1>
      Smarte løsninger
    </h1>
  </article>

  <article class='smaller'>
    <h3>
      Smarte løsninger - Bruk av namespace
    </h3>

    <ul>
      <li>
        Problem: globale variabler
      </li>
      <li>
        Løsning: bruk av namespacing
      </li>
    </ul>
    <section>
        <pre>
var booking = (function () {
  function namespace(string) {
    var object = this;
    var levels = string.split(".");
    for (var i = 0, l = levels.length; i < l; i++) {
      if (typeof object[levels[i]] == "undefined") {
        object[levels[i]] = {};
      }
      object = object[levels[i]];
    }
    return object;
  }
  return {
    namespace: namespace
  };
}());
        </pre>
    </section>
  </article>
  <article>
    <h3>
      Smarte løsninger - Bruk av namespace
    </h3>
    <br/>
    <p>Tips: la mappestrukturen i prosjekte speile namespace-hierarkiet</p>
    <section>
        <pre>
var utils = booking.namespace("utils");

utils.multiply = function(x, y) {
  return x * y;
};

var number = booking.utils.multiply(2.2, 2);
        </pre>
    </section>
  </article>

  <article>
     <h3>
       Smarte løsninger - Arv
     </h3>

     <ul>
       <li>
         Problem: Definere arv er litt knotete i JavaScript
       </li>
       <li>
         Løsning: Object.create(MotherObject);
       </li>
     </ul>
     <section>
         <pre>
if (!Object.create) {
  (function () {
    function F() {}

    Object.create = function (object) {
      F.prototype = object;
      return new F();
    };
  }());
}
         </pre>
     </section>
   </article>
  <article>
     <h3>
       Smarte løsninger - Arv
     </h3>

     <section>
         <pre>
var square = {
  length : 2,
  depth : 4,
  area : function() { return this.length * this.depth; }
};

var box = Object.create(square);
box.height = 10;
box.length = 1;
box.volume = function() {return this.height * this.area();};

box.area(); // 4
box.volume(); // 40
square.area(); // 8
square.volumne(); // undefined
         </pre>
     </section>
   </article>

  <article class="smaller">
     <h3>
      Smarte løsninger - sette this for en metode
     </h3>

     <ul>
       <li>
         Problem: bruke “this” i en callback vi sender fra oss
       </li>
       <li>
         Løsning: someMethod.bind(this);
       </li>
     </ul>
     <section>
         <pre>
if (!Function.prototype.bind) {
  (function () {
    var slice = Array.prototype.slice;

    Function.prototype.bind = function (thisObj) {
      var target = this;

      if (arguments.length > 1) {
        var args = slice.call(arguments, 1);

        return function () {
          var allArgs = args;

          if (arguments.length > 0) {
            allArgs = args.concat(slice.call(arguments));
          }

...
        </pre>
     </section>
   </article>
  <article>
     <h3>
       Smarte løsninger - sette this for en metode
     </h3>

     <section>
         <pre>
function handleButtonClick(event) {
  this.controller.fetchPrice(this.weight.val());
}

function init(controller, pageObject) {
  ...

  pageObject.button.click(this.handleButtonClick.bind(this));
}
         </pre>
     </section>
   </article>

  <article>
    <h1>
      Testing
    </h1>
  </article>

  <article>
    <h3>
        Rammeverk
    </h3>
    <ul>
      <li>
        Jasmine
      </li>
      <ul style="font-size: 22px">
        <li>
          BDD rammeverk
        </li>
        <li>
          Specifications and asserts
        </li>
        <li>
          Kjører i nettleser eller i maven
        </li>
        <ul style="font-size: 20px">
          <li>
            ctrl + r
          </li>
          <li>
            mvn test
          </li>
        </ul>
      </ul>
      <li>
        Sinon
      </li>
      <ul style="font-size: 22px">
        <li>
          Spy / stub / mock
        </li>
        <li>
          Jasmine integrasjon
        </li>
      </ul>
    </ul>
  </article>

  <article>
    <h3>
      Eksempler
    </h3>
    <pre>
  describe(“Circle”, function() {
    it(“should compute area”, function() {
      var circle = new Circle();
      circle.radius = 1;
      expect(circle.area()).toEqual(3.14);
    });
  });
    </pre>
  </article>

  <article>
    <h3>
      Sinon
    </h3>
    <pre>
  //Spy: Capture kall
  var fn = sinon.spy();
  // ..... 
  expect(fn).toHaveBeenCalled();

  //Stub: Returnerer verdier 
  var areaStub = sinon.stub().returns(3.14); 
  circle.area = areaStub;    //bytt ut funksjon

  //Mock: Verifiserer bruk 
  var mock = sinon.mock(circle).expects(“area”).once();
  // ...... 
  mock.verify(); 
    </pre>
  </article>

  <article>
    <h1>
      Eksempel: Ajax
    </h1>
  </article>

  <article>
    <h1>
      Eksempel: Controller + View
    </h1>
  </article>

  <article>
    <h1>
      Lesson learned
    </h1>
  </article>

  <article>
    <h3>
      Lesson learned
    </h3>
    <ul>
      <li>
        Lav terskel for å komme i gang, høy terskel for å skrive god kode
      </li>
      <li>
        Mange fete muligheter i JavaScript
      </li>
      <li>
        Krever at alle på teamet <strong>lærer</strong> seg JavaScript
      </li>
      <li>
        Innføring av tester og strukturert kode === høy terskel å komme i gang
      </li>
      <li>
        Mye lettere å vedlikeholde for alle
      </li>
      <li>
        "Utils"-metoder må defineres først
      </li>
      <li>
        Pass på verdi av this
      </li>
    </ul>
  </article>

  <article>
    <h3>
      Oppsummering
    </h3>
    <ul>
      <li>
        Hvorfor gjøre noe annet enn vi gjør i dag?
      </li>
      <li>
        JavaScript fundamenter
      </li>
      <li>
        Smarte løsninger
      </li>
      <li>
        Testing
      </li>
      <li>
        Eksempel: Ajax
      </li>
      <li>
        Eksempel: Controller + View
      </li>
      <li>
        Lesson learned
      </li>
    </ul>
  </article>

  <article>
    <h1>
      Tips til presentasjonen på fagdagen?
    </h1>
  </article>

  <article>
    <h1>
      Takk for oss
    </h1>

    <div class='author'>
      Christian Schwarz og Lars Brandt
    </div>
  </article>


</section>
</body>
</html>
